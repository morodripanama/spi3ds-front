<!doctype html>
<html lang="es">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>SPI 3DS Demo – SmartPayPasarelas</title>
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <header>
    <h1>SPI 3DS – Demo <small class="badge">/api/spi/sale</small></h1>
  </header>

  <main>
    <div class="grid">

      <section class="card two">
        <h2>Configuración</h2>
        <div class="content">
          <label>API Base</label>
          <input id="apiBase" value="https://smartpaypasarelas.onrender.com">

          <label>Merchant Response URL</label>
          <input id="merchantUrl" value="https://smartpaypasarelas.onrender.com/api/spi/3ds/return">

          <div class="row">
            <div>
              <label>TerminalId (opcional)</label>
              <input id="terminalId" placeholder="">
            </div>
            <div>
              <label>Order Identifier</label>
              <input id="orderId" value="TEST123">
            </div>
          </div>
        </div>
      </section>

      <section class="card two">
        <h2>Monto y Moneda</h2>
        <div class="content">
          <div class="row">
            <div>
              <label>Monto</label>
              <input id="amount" type="number" step="0.01" value="12.34">
            </div>
            <div>
              <label>Moneda</label>
              <select id="currency">
                <option value="840">USD (840)</option>
                <option value="590">PAB (590)</option>
              </select>
            </div>
          </div>
        </div>
      </section>

      <section class="card three full">
        <h2>Datos de tarjeta</h2>
        <div class="content">
          <div class="row-3">
            <div>
              <label>Card PAN</label>
              <input id="pan" value="4012000000020006">
            </div>
            <div>
              <label>Expiración <span class="muted">(MM/YY)</span></label>
              <input id="exp" value="12/28">
            </div>
            <div>
              <label>CVV</label>
              <input id="cvv" value="123">
            </div>
          </div>
        </div>
      </section>

      <section class="card three">
        <h2>Cliente</h2>
        <div class="content">
          <div class="row">
            <div><label>Nombre</label><input id="firstName" value="Moises"></div>
            <div><label>Apellido</label><input id="lastName" value="Rodriguez"></div>
          </div>
          <div class="row">
            <div><label>Email</label><input id="email" value="morodri@smart-retail-group.com"></div>
            <div><label>Teléfono</label><input id="phone" value="+50766788044"></div>
          </div>
        </div>
      </section>

      <section class="card three">
        <h2>Billing Address</h2>
        <div class="content">
          <label>Dirección 1</label><input id="billLine1" value="Calle 50">
          <label>Dirección 2</label><input id="billLine2" value="">
          <div class="row">
            <div><label>Ciudad</label><input id="billCity" value="Panamá"></div>
            <div><label>Estado/Provincia</label><input id="billState" value="PA"></div>
          </div>
          <div class="row">
            <div><label>Código Postal</label><input id="billZip" value="0801"></div>
            <div><label>País (ISO-2)</label><input id="billCountry" value="PA"></div>
          </div>
          <div class="checkbox">
            <input id="shipSame" type="checkbox" checked>
            <label for="shipSame">Shipping igual a Billing</label>
          </div>
        </div>
      </section>

      <section class="card three">
        <h2>Shipping Address</h2>
        <div class="content">
          <label>Dirección 1</label><input id="shipLine1" placeholder="">
          <label>Dirección 2</label><input id="shipLine2" placeholder="">
          <div class="row">
            <div><label>Ciudad</label><input id="shipCity" placeholder=""></div>
            <div><label>Estado/Provincia</label><input id="shipState" placeholder=""></div>
          </div>
          <div class="row">
            <div><label>Código Postal</label><input id="shipZip" placeholder=""></div>
            <div><label>País (ISO-2)</label><input id="shipCountry" placeholder=""></div>
          </div>
          <p class="muted">Si está marcado “Shipping igual a Billing”, estos campos se ignorarán.</p>
        </div>
      </section>

      <section class="card full">
        <h2>Acciones</h2>
        <div class="content">
          <div class="actions">
            <button id="btnSale">Iniciar /spi/Sale (3DS)</button>
            <button id="btnAuth3ds">Iniciar /spi/Auth (3DS)</button>
            <label style="display:block;margin-top:.5rem">
              <input type="checkbox" id="authNo3ds"> Auth SIN 3DS
            </label>
            <button id="btnTxn" class="secondary" title="Consulta usando el TransactionIdentifier del último 3DS">Ver
              estado (GET /transactions/{id})</button>
            <button id="btnCapture" class="secondary" title="Capturar transacción">Capturar
              (/transactions/{id}/capture)</button>
            <button id="btnVoid" class="secondary" title="Anular (/transactions/{id}/void)">Anular</button>
            <button id="btnRefund" class="secondary" title="Reembolsar (/transactions/{id}/refund)">Reembolsar</button>
            <button id="btnSearch" class="secondary" title="Buscar transacciones">Buscar (GET /transactions)</button>

          </div>
          <div id="saleStatus" class="muted" style="margin-top:8px;"></div>
          <p class="muted">Tras completar 3DS, si llega el SpiToken, se llamará <code>/api/spi/payment</code>
            automáticamente.</p>
        </div>
      </section>

      <section class="card full">
        <h2>Resultado</h2>
        <div class="content">
          <pre id="log">Listo.
— Pulsa «Iniciar /spi/Sale (3DS)» y sigue el flujo.
— Tras 3DS, si llega el SpiToken, se llamará /api/spi/payment.</pre>
        </div>
      </section>

    </div>
  </main>

  <script src="app.js?v=3"></script>
</body>

</html>